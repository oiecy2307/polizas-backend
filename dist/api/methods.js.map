{"version":3,"sources":["../../src/api/methods.js"],"names":["sequelize","User","Event","Assistant","Talk","router","express","Router","route","post","req","res","body","email","password","type","name","findOne","where","then","userResponse","status","json","user","build","save","result","catch","err","send","topic","date","scheduleStart","scheduleEnd","address","diary","event","get","findAll","active","events","patch","id","params","findByPk","Object","entries","key","value","userId","assistants","assistant","userName","title","aboutTalk","aboutYou","twitter","linkedin","facebook","talk"],"mappings":"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","file":"methods.js","sourcesContent":["import express from 'express';\n\n// export default (sequelize, Vehiculo) => {\nexport default (sequelize, User, Event, Assistant, Talk) => {\n\tconst router = express.Router();\n\n\trouter.route('/new-user')\n\t\t.post((req, res) => {\n\t\t\tconst {\n\t\t\t\temail,\n\t\t\t\tpassword,\n\t\t\t\ttype,\n\t\t\t\tname,\n\t\t\t} = req.body;\n\t\t\tUser.findOne({ where: { email } })\n\t\t\t.then((userResponse) => {\n\t\t\t\tif (userResponse) {\n\t\t\t\t\tres.status(200).json(userResponse);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst user = User.build({\n\t\t\t\t\temail,\n\t\t\t\t\tpassword,\n\t\t\t\t\ttype,\n\t\t\t\t\tname,\n\t\t\t\t});\n\t\t\t\tuser.save()\n\t\t\t\t.then((result) => {\n\t\t\t\t\tres.status(200).json(result);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tres.status(500).send(err);\n\t\t\t\t});\n\t\t\t})\n\t\t});\n\n\trouter.route('/new-event')\n\t\t.post((req, res) => {\n\t\t\tconst {\n\t\t\t\ttopic,\n\t\t\t\tdate,\n\t\t\t\tscheduleStart,\n\t\t\t\tscheduleEnd,\n\t\t\t\taddress,\n\t\t\t\tdiary,\n\t\t\t} = req.body;\n\t\t\tconst event = Event.build({\n\t\t\t\ttopic,\n\t\t\t\tdate,\n\t\t\t\tscheduleStart,\n\t\t\t\tscheduleEnd,\n\t\t\t\taddress,\n\t\t\t\tdiary,\n\t\t\t});\n\t\t\tevent.save()\n\t\t\t.then((result) => {\n\t\t\t\tres.status(200).json(result);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tres.status(500).send(err);\n\t\t\t});\n\t\t});\n\n\trouter.route('/events')\n\t\t.get((req, res) => {\n\t\t\tEvent.findAll({\n\t\t\t\twhere: {\n\t\t\t\t\tactive: 1,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.then((events) => {\n\t\t\t\tres.status(200).json(events);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tres.status(500).send(err);\n\t\t\t});\n\t\t});\n\n\trouter.route('/delete-event/:id')\n\t\t.patch((req, res) => {\n\t\t\tconst { id } = req.params;\n\n\t\t\tEvent.findByPk(id)\n\t\t\t.then((event) => {\n\t\t\t\tevent.active = 0;\n\t\t\t\tevent\n\t\t\t\t.save()\n\t\t\t\t.then(() => {\n\t\t\t\t\tres.status(200).json(event);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tres.status(500).send(err);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\trouter.route('/event/:id')\n\t\t.patch((req, res) => {\n\t\t\tconst { id } = req.params;\n\n\t\t\tEvent.findByPk(id)\n\t\t\t.then((event) => {\n\t\t\t\tfor (const [key, value] of Object.entries(req.body)) {\n\t\t\t\t\tevent[key] = value;\n\t\t\t\t}\n\t\t\t\tevent\n\t\t\t\t.save()\n\t\t\t\t.then(() => {\n\t\t\t\t\tres.status(200).json(event);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tres.status(500).send(err);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\n\t\trouter.route('/assistants/:userId')\n\t\t\t.get((req, res) => {\n\t\t\t\tconst { userId } = req.params;\n\t\t\t\tAssistant.findAll({\n\t\t\t\t\twhere: {\n\t\t\t\t\t\tuser: userId,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t.then((assistants) => {\n\t\t\t\t\tres.status(200).json(assistants);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tres.status(500).send(err);\n\t\t\t\t});\n\t\t\t});\n\n\t\trouter.route('/assistants')\n\t\t\t.post((req, res) => {\n\t\t\t\tconst {\n\t\t\t\t\tuser,\n\t\t\t\t\tevent,\n\t\t\t\t} = req.body;\n\t\t\t\tconst assistant = Assistant.build({\n\t\t\t\t\tuser,\n\t\t\t\t\tevent,\n\t\t\t\t});\n\t\t\t\tassistant.save()\n\t\t\t\t.then((result) => {\n\t\t\t\t\tres.status(200).json(result);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tres.status(500).send(err);\n\t\t\t\t});\n\t\t\t});\n\n\t\trouter.route('/talk')\n\t\t\t.post((req, res) => {\n\t\t\t\tconst {\n\t\t\t\t\tuser,\n\t\t\t\t\tuserName,\n\t\t\t\t\temail,\n\t\t\t\t\ttitle,\n\t\t\t\t\taboutTalk,\n\t\t\t\t\taboutYou,\n\t\t\t\t\ttwitter,\n\t\t\t\t\tlinkedin,\n\t\t\t\t\tfacebook,\n\t\t\t\t} = req.body;\n\t\t\t\tconst talk = Talk.build({\n\t\t\t\t\tuser,\n\t\t\t\t\tuserName,\n\t\t\t\t\temail,\n\t\t\t\t\ttitle,\n\t\t\t\t\taboutTalk,\n\t\t\t\t\taboutYou,\n\t\t\t\t\ttwitter,\n\t\t\t\t\tlinkedin,\n\t\t\t\t\tfacebook,\n\t\t\t\t});\n\t\t\t\ttalk.save()\n\t\t\t\t.then((result) => {\n\t\t\t\t\tres.status(200).json(result);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tres.status(500).send(err);\n\t\t\t\t});\n\t\t\t});\n\n\t\treturn router;\n};\n"]}